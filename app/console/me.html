<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="../../css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="../../css/custom.css">
		<style>
			* {
				padding: 0;
				margin: 0;
				box-sizing: border-box;
			}
			html,body,#vm{
				height: 100%;
			}
			a {
				color: #000;
			}
			.filter{
				width:100%;usertitle
			}
			.filter a {
				display: block;
				width: 80%;
				height: 50px;
				line-height: 50px;
				font-size: 13px;
				padding-left: 20px;
			}
			
			.filter{
				margin-bottom: 20px;
				padding-top: 20px;
				padding-left: 20px;
			}
			.filter ul li{
				display: flex;
				align-items: center;
				position: relative;
				flex-wrap: wrap;
			}
			.filter ul li img{
				width: 68px;
				height: 68px;
			}
			.filter ul li span{
				display: block;
				height: 23px;
			}
			.filter ul li div{
				padding-left: 10px;
				font-size: 14px;
			}
			.filter .userentry {
				border-bottom: 1px solid #ccc;
			}
			.filter .border_bottom{
				display: block;
				width:100%;
				height: 1px;
				background: #ccc;
				left: 30px;
				bottom: 0px;
			}
			.mui-bar .mui-icon {
				font-size: 32px;
			}
			
			.mui-bar-nav.mui-bar .mui-icon {
				margin-right: -10px;
				margin-left: -10px;
				padding-right: 10px;
				padding-left: 10px;
				padding-top: 23px;
				padding-bottom: 10px;
				font-weight: bold;
				font-size: 40px;
			}
			
			.mui-bar .mui-title {
				right: 50px;
				left: 50px;
				
			}
			
			.mui-content {
				background: white;
				display: flex;
				flex-direction: column;
			}

			.usertitle {
				width:100%;
				background: #f2f2f2;
				height: 30px;
			}
			.personnelInfo{
				width:100%;
				overflow: hidden;
				flex: 1;
			}
			.personnelInfo ul li{
				height: 70px;
			}
			.personnelInfo .mui-table-cell {
				display: flex;
			}
			
			.personnelInfo .img-content {
				width: 25%;
				display: flex;
				align-items: center;
				height: 60px;
			}
			
			.personnelInfo .main-content {
				width: 75%;
				padding-top: 12px;
			}
			.personnelInfo .main-content :nth-child(2){
				position: relative;
				top:-4px;
			}
			.main-content .name,.mui-content .group{
				font-size: 13px;
			}
			.personnelInfo .main-content .group{
				top:4px;
			}
			.main-content .pinyin{
				font-size: 11px;
			}
			.personnelInfo img {
				width: 36px;
				height:36px;
				border-radius: 5px;
				position: relative;
				border: 1px solid #0b60de;
				
			}
			
			.personnelInfo .main-content div {
				display: flex;
				justify-content: space-between;
			}
			
			.personnelInfo .status {
				position: relative;
				top: -3px;
				background: linear-gradient(to bottom,#aeaeae,#707070);
				width: 16px;
				height: 16px;
				border-radius: 50px;
				border: 1px solid white;
				box-shadow: 0px 2px 4px 1px rgba(0, 0, 0, .25);
			}
			
			.personnelInfo .main-content .active {
				background: linear-gradient(to bottom,#39e131,#31bd2a);
				top:-2px;
			}
			
			.personnelInfo .mui-slider-right a:nth-child(1) {
				background: #00cc66;
			}
			
			.personnelInfo .mui-slider-right a:nth-child(2) {
				background: #ff9966;
			}
			
			.personnelInfo .mui-slider-right a:nth-child(3) {
				background: #0099ff;
			}
			
			.personnelInfo .mui-table-view-cell {
				padding: 0 10px;
			}
			
			.mui-table-view-cell:after {
				left:0;
				background-color: #ccc;
			}
			
			#topPopover .mui-table-view-cell a {
				display: flex;
				align-items: center;
				font-size: 20px;
			}
			
			#topPopover .mui-table-view-cell a img {
				margin-right: 20px;
			}
			
			#topPopover .mui-table-view-cell {
				border-bottom: 1px solid #ddd;
			}
			
			.mui-popover {
				height: 300px;
			}
			
			.mui-popover {
				width: 180px;
				height: 166px;
				box-shadow: 0 0 15px rgba(0, 0, 0, .3);
				background: white;
			}
			
			.mui-backdrop {
				background: transparent;
			}
			
			.mui-scroll-wrapper,
			.mui-popover .mui-popover-arrow:after,
			.mui-scroll-wrapper .mui-table-view-cell {
				/*background: #49484a;
				color: white;*/
			}
			
			.mui-popover .mui-scroll-wrapper {
				margin: 0;
			}
			
			.mui-popover .mui-table-view .mui-table-view-cell:last-child,
			.mui-popover .mui-table-view .mui-table-view-cell:last-child,
			.mui-popover .mui-table-view .mui-table-view-cell:last-child>a:not(.mui-btn),
			.mui-popover .mui-table-view .mui-table-view-cell:first-child>a:not(.mui-btn) {
				border-bottom-left-radius: 0;
				border-bottom-right-radius: 0;
				border-top-left-radius: 0;
				border-top-right-radius: 0;
			}
			.userEntryImg{
				display: inline-block;
				width:22px;
				height: 22px;
				background: url(../../public/img/user_icon01.png) no-repeat;
				background-size: 19px 22px;
				margin-left: 5px;
			}
			.userfilter{
				display: inline-block;
				width:22px;
				height: 22px;
				background: url(../../public/img/user_icon02.png) no-repeat;
				background-size: 19px 22px;
				margin-left: 5px;
			}
			.mui-content .mui-icon{
				color:#ccc;
				position: relative;
				left:15px;
			}
			.mui-content .mui-icon{
				color:#ccc;
				position: absolute;
				right:15px;
				top:13px;
			}
			.mui-popover .mui-table-view{
				background: white;
			}
			.mui-popover .mui-table-view{
				border-radius: 0;
			}
			.mui-popover .mui-popover-arrow:after{
				background: white;
			}
			#topPopover .mui-table-view-cell a span{
				display: inline-block;
				width: 100%;
				text-align: center;
			}
			.btn a{
				width:100%;
				font-size: 20px;
				display: block;
				padding: 16px 16px;
				position: relative;
			}
			.btn a span{
				font-size: 18px;
				color: #999;
				position: absolute;
				right:20px;
			}
		</style>
	</head>

	<body>
		<div id="vm">
			<header class="mui-bar mui-bar-nav">
				<a id="menu" class="mui-action-menu mui-icon mui-icon-plusempty mui-pull-right" href="#topPopover"></a>
				<h1 class="mui-title">南方云</h1>
			</header>
			<div class="mui-content">
				<div class="filter">
					<ul class="filter-ul">
						<li href="../personnel/userinfo.html" class="filter-li">
							<img src="../../public/img/01.jpg" alt="" class="img" />
							<div>
								<span>张三</span>
								<span>zhangsan</span>
								<span>白云组</span>
							</div>
						</li>
					</ul>
				</div>
				<div class="usertitle"></div>
				<div class="btn">
					<a>关联设备
					<span>点击检测关联设备</span>
					</a>
				</div>
				<div class="usertitle"></div>
				<div class="personnelInfo">
					<ul class="mui-table-view">
						<li class="mui-table-view-cell" v-for="(item,index) in userdata">
						</li>
					</ul>
				</div>
			</div>

			<!--右上角弹出菜单-->
			<div id="topPopover" class="mui-popover">
				<div class="mui-popover-arrow"></div>
				<div class="mui-scroll-wrapper">
					<div class="mui-scroll">
						<ul class="mui-table-view">
							<li class="mui-table-view-cell" href="../personnel/userEntry.html">
								<a href="#">
									<span>设备关联</span></a>
							</li>
							<li id="logout" class="mui-table-view-cell">
								<a href="#">
									<span>退出帐号</span></a>
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
		<script src="../../js/mui.min.js"></script>
		<script src="../../js/url.js"></script>
		<script src="../../js/vue.min.js"></script>
		<script type="text/javascript">
			mui.init({
				beforeback: function() {},
			});
			mui.plusReady(function() {});
			var vm = new Vue({
				el: '#vm',
				data: {
					token:'',
					user_name:'',
					rtkCount:'',
					onlineRtkCount:'',
					mapRtk:'',
					userdata: [{
							name: '张三',
							pinyin: 'zhangsan',
							group: '南方卫星导航',
							status: 0
						},
						{
							name: '李四',
							pinyin: 'lisi',
							group: '南方卫星导航',
							status: 0
						},
						{
							name: '姚明',
							pinyin: 'yaoming',
							group: '南方卫星导航',
							status: 1
						},
						{
							name: '王五',
							pinyin: 'wangwu',
							group: '南方卫星导航',
							status: 1
						},
						{
							name: '王五',
							pinyin: 'wangwu',
							group: '南方卫星导航',
							status: 1
						},
						{
							name: '姚明',
							pinyin: 'yaoming',
							group: '南方卫星导航',
							status: 1
						},
						{
							name: '王五',
							pinyin: 'wangwu',
							group: '南方卫星导航',
							status: 1
						},
						{
							name: '王五',
							pinyin: 'wangwu',
							group: '南方卫星导航',
							status: 1
						}
					],
				},
				methods: {
					openpage: function() {
						var data_url = event.target.dataset.href;
						mui.openWindow({
								url: data_url,
								id: data_url
							});
					}
				},
				created: function() {
					mui.plusReady(function() {
						mui.init({});
						//页面顶部筛选按钮跳转
						mui('.filter-ul').on('tap', '.filter-li', function(e) {
							var url = this.getAttribute('href');
							mui.openWindow({
								url: url,
								id: url
							});
						});
						//右上角弹出窗链接跳转
						mui('#topPopover .mui-table-view').on('tap', '.mui-table-view-cell', function(e) {
							var url = this.getAttribute('href');
							mui.openWindow({
								url: url,
								id: url
							});
							document.querySelector('#topPopover').style.display = "none";
							document.querySelector('.mui-backdrop').style.display = "none";
							document.querySelector('#topPopover').className ='mui-popover';
						});
						
						//登陆时存放到本地的数据
						vm.token = plus.storage.getItem('token');
						vm.user_name = plus.storage.getItem('user_name');
						vm.rtkCount = plus.storage.getItem('rtkCount') || 0;
						vm.onlineRtkCount = plus.storage.getItem('onlineRtkCount') || 0;
						vm.mapRtk = plus.storage.getItem('mapRtk') || 0;
						
						
						document.getElementById('logout').addEventListener('tap', function() {
							mui('#logout').button('loading');
							var lauchFlag = plus.storage.getItem('lauchFlag');
							plus.storage.clear();
							plus.storage.setItem('lauchFlag', lauchFlag);

							mui('#logout').button('reset');

							mui.ajax(apiUrl.logout, {
								data: {
									user_name: vm.user_name,
									token: vm.token
								},
								dataType: 'json',
								type: 'post',
								timeout: 10000,
								success: function(data) {
									if(data.status === 0 || data.status === 40004) {
										mui.openWindow({
											url: '../../login.html',
											id: 'login'
										});
										
										var lauchFlag = plus.storage.getItem('lauchFlag');
										plus.storage.clear();
										plus.storage.setItem('lauchFlag', lauchFlag);
									}
									mui('#logout').button('reset');
								},
								error: function(xhr, type, errorThrown) {
									onNetChange();
									mui('#logout').button('reset');
								}
							});
						});
					});
				}
			});
			function getdata(){
				mui.ajax(apiUrl.device_list, {
					data: {
						user_name: vm.user_name,
						token: vm.token
					},
					dataType: 'json',
					type: 'post',
					timeout: 10000,
					success: function(data) {
						console.log('获取数据成功');
						console.log(JSON.stringify(data));
					}
				});
			};
		</script>
	</body>

</html>